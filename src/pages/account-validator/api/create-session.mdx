export const sectionMode = 'nav';
export const description =
  'Account Validator es un proyecto encargado de la verificación de cuentas a través de servicios externos.'

export const apiRefs = ['/api/create-session', '/api/check-session-status', '/api/validate-existing-account'];

## Crear una Sesión {{ id: 'create-a-session', tag: 'POST', label: '/api/verification/session' }}

<Row>
  <Col>
    Este endpoint te permite crear una sesión de verificación de cuenta.

    <ApiReader
      path="/api/create-session"
      method="post"
      api={props.refs}
    />

  </Col>
  <Col sticky>
    <CodeGroup title="Solicitud" tag="POST" label="/api/session">
    ```bash {{ title: 'cURL' }}
    curl -X "POST" https://checkout-test.placetopay.com/api/verification/session \
      -H "Content-Type: application/json" \
      -d '{
          "locale": "es_CO",
          "auth": {
            "login": "5991de4fa93bcd7b28cf5100c25099e1",
            "tranKey": "OoamCdSidq121234430nH5x94yxd4=",
            "nonce": "NG5vejc2b41xdm8=",
            "seed": "2024-04-19T12:06:56-05:00"
          },
          "user": {
            "name": "John",
            "surname": "Doe",
            "email": "john_doe@mail.com"
          },
          "returnUrl": "https://www.placetopay.com",
          "locale": "es_PR"
      }'
    ```
    </CodeGroup>
  </Col>
</Row>

<Row>
  <Col>
    <ApiReader
      path="/api/create-session"
      method="post"
      type="response"
      api={props.refs}
    />
  </Col>

  <Col sticky>
    <br />
    <CodeGroup title="Respuesta">
    ```json {{ title: '200' }}
    {
      "status": {
        "status": "OK",
        "reason": "00",
        "message": "string",
        "date": "2021-09-21T09:34:48-05:00"
      },
      "data": {
        "requestId": "9bd89c8d-6097-4d69-8ce9-d9b5ec35d8ea",
        "redirectUrl": "https://account-validator.placetopay.com/verification/redirect/9bd89c8d-6097-4d69-8ce9-d9b5ec35d8ea",
        "expiresAt": "2024-04-19 17:36:57"
      }
    }
    ```
    ```json {{ title: '400' }}
    {
      "status": {
        "status": "FAILED",
        "reason": "BR",
        "message": "El campo user.email es obligatorio.",
        "date": "2024-04-19T20:15:04+00:00"
      },
    }
    ```
    </CodeGroup>
  </Col>
</Row>

---

## Consultar estado de  sesión {{ id: 'check-session-status', tag: 'POST', label: '/api/verification/query' }}

   Este endpoint te permitirá consultar el estado de la sesión creada.

    <Note>
      La información de la cuenta solo se mostrará los primeros 10 minutos, sí solo si, la verificación de cuenta fue exitosa..
    </Note>

 ### Posibles estados

 Nombre | Descripción
 ---------|----------
  APPROVED | La cuenta fue verificada exitosamente.
  REJECTED | La verificación de cuenta fue rechazada.
  FAILED | Ha ocurrido un error en el sistema.
  PENDING | La verificación de cuenta está en proceso.


  ### Razones de estado

  Código | Descripción
  ---------|----------
   ?C | La verificación ha sido cancelada por el usuario.
   05 | La verificación ha sido rechazada por razones generales.
   BR | Los datos de la solicitud han sido incorrectos.
   00 | La verificación ha sido realizada con éxito.
   ?- | La verificación está en proceso de validación.
   38 | Número de intentos agotado.
   HX | Ha ocurrido un error en el servicio.
   X3 | La información suministrada es inválida.
   X5 | Número de seguridad social Inválido.
   XN | Número de cuenta inválido.
   ?* | Pendiente de validación por microdepositos.

<Row>
  <Col>
    <ApiReader
      path="/api/check-session-status"
      method="post"
      api={props.refs}
    />
  </Col>

   <Col sticky>
      <CodeGroup title="Solicitud" tag="POST" label="api/verification/query">
      ```bash {{ title: 'cURL' }}
      curl -X "POST" https://checkout-test.placetopay.com/api/verification/query \
        -H "Content-Type: application/json" \
        -d '{
              "auth": {
                "login": "5991de4fa93bcd7b28cf5100c25099e1",
                "tranKey": "OoamCdSidq121234430nH5x94yxd4=",
                "nonce": "NG5vejc2b41xdm8=",
                "seed": "2024-04-19T12:06:56-05:00"
              },
              "requestId": "1f630ff7-9c02-4da4-82d4-d676709acb21"
        }'
      ```
      </CodeGroup>
    </Col>
</Row>

<Row>
  <Col>
    <ApiReader
      path="/api/check-session-status"
      method="post"
      type="response"
      api={props.refs}
    />
  </Col>

  <Col sticky>
    <br />
    <CodeGroup title="Respuesta">
    ```json {{ title: '200' }}
    {
      "status": {
        "status": "PENDING",
        "reason": "?-",
        "message": "La solicitud está pendiente",
        "date": "2022-08-30T18:33:25+00:00"
      },
      "data": {
        "requestId": "9bd8e975-c793-4888-afa7-15faee550fa5",
        "expiresAt": "2024-04-19 21:12:00"
      }
    }
    ```
    ```json {{ title: '400' }}
    {
      "status": {
        "status": "REJECTED",
        "reason": "BR",
        "message": "There are no results for the query",
        "date": "2024-04-19T21:11:09+00:00"
      }
    }
    ```
    </CodeGroup>
  </Col>
</Row>

---

## Validar Cuenta existente {{ id: 'validate-existing-account', tag: 'POST', label: '/api/verification/validate' }}

    Una vez realizada de manera exitosa la creación inicial de la sesión podrá realizar validaciones a la cuenta las veces que considere necesarias, solo debe tener la información de la cuenta y el código de verificación entregado en el proceso anterior.

    **Validaciones realizadas:**

    Actualmente el resultado de las validaciones se basa en las siguientes reglas:

    1. **Validación de cuenta existente:** Se verifica que la cuenta exista y haya pasado por un proceso de creación de la sesión desde la interfaz gráfica del verificador de cuentas y además el token generado pertenezca al comercio con el cual se está autenticando.
    2. **Validación de cuenta activa:** Se verifica que la cuenta exista y este activa en el proveedor de validación de cuentas, (PLAID, VaulPopular, Cuentas Comerciales, o el MOCK según corresponda).
    3. **Validación de monto disponible:** Se verifica que la cuenta a validar tenga un monto mayor o igual al monto enviado en la solicitud.

### Razones de estado

Código | Descripción
---------|----------
 05 | La verificación ha sido rechazada por razones generales.
 BR | Los datos de la solicitud han sido incorrectos.
 00 | La verificación ha sido realizada con éxito.
 XA | Monto no disponible para esta cuenta.
 HX | Ha ocurrido un error en el servicio.
 X3 | La información suministrada es inválida.
 X5 | Número de seguridad social Inválido.
 XN | Número de cuenta inválido.


 ### Posibles estados

 Nombre | Descripción
 ---------|----------
  APPROVED | La cuenta fue verificada exitosamente.
  REJECTED | La verificación de cuenta fue rechazada.
  FAILED | Ha ocurrido un error en el sistema.


<Row>
  <Col>
    <ApiReader
      path="/api/validate-existing-account"
      method="post"
      api={props.refs}
    />
  </Col>

   <Col sticky>
      <CodeGroup title="Solicitud" tag="POST" label="api/verification/validate">
      ```bash {{ title: 'cURL' }}
      curl -X "POST" https://checkout-test.placetopay.com/api/verification/validate \
        -H "Content-Type: application/json" \
        -d '{
              "auth": {
                "login": "5991de4fa93bcd7b28cf5100c25099e1",
                "tranKey": "OoamCdSidq121234430nH5x94yxd4=",
                "nonce": "NG5vejc2b41xdm8=",
                "seed": "2024-04-19T12:06:56-05:00"
              },
              "account": {
                "bankCode": "221571473",
                "bankName": "FIRSTBANK PUERTO RICO",
                "accountType": "CCD",
                "accountNumber": "41111111111111111",
                "franchise": "_221571473_",
                "verificationCode": "eyJhbYuiOiJSUzI1NmS1.eyJhY2NvdW50SGFzaCI6IjhkMzJkN2VjYjEyZDZmYjRmN2VlZmMzN2U4MmY2ZjI3YzNiYmY5Nzc3NjJkODAxZjQxYWZhN2Q0NWQ2YzI4YzU5YTU2NTM3YmZhM2E0NTM0MzhiMmU5M2Q4ODVkZDRiNDA1MjM5MjUwY2QzZGFkMDhhMzM2ZTJjYjM0Mjg0Y2RiIiwib25UZXN0IjpmYWxzZSwic2VydmljZSI6InBybWxjIiwiaWQiOjM4OX0.bXBuhT_xhA5vKJv3yVFJXYSYFJ4d49gmWuK2AC33GUfviAs2gSxrwZ8EHtFH4w37Pjzmq3y96uQZrllroGSlF7PySRqwxfNnem92ZKOs4EsFkzOdfBh73Z-RmCpKY6n5BQDjvVIg8hkwb2umnotjig1Zz_yHCBcvqQj5qkjj1N8HyT3KQtTOzItfDb4qf7uEAzONbcSN8YRYuRKvBMxKgJMSdeIu8Ah3zMOAhLxa1X0XnRr0a1gYudqQLowpnwQ7SP31Y_I3IlrXdBZqIYI12cciY_N1c11MsDuM1mtWhA0aJeVVzgdyq_DS0WOAiZy6Lsd26vY1ZR5Q5OsHYVIF5g"
              },
              "payment": {
                "amount": {
                  "currency": "USD",
                  "total": 100
                }
              },
              "locale": "es_ES"
        }'
      ```
      </CodeGroup>
    </Col>
</Row>

<Row>
  <Col>
    <ApiReader
      path="/api/validate-existing-account"
      method="post"
      type="response"
      api={props.refs}
    />
  </Col>

  <Col sticky>
    <br />
    <CodeGroup title="Respuesta">
    ```json {{ title: '200' }}
    {
        "status": "APPROVED",
        "reason": "00",
        "message": "La verificación ha sido exítosa",
        "date": "2024-04-19T20:51:52+00:00"
    }
    ```
    ```json {{ title: '400' }}
    {
      "status": {
        "status": "FAILED",
        "reason": "BR",
        "message": "El payment.amount.currency seleccionado no es válido.",
        "date": "2024-04-19T21:33:00+00:00"
      }
    }
    ```
    </CodeGroup>
  </Col>
</Row>
