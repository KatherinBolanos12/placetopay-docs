import SequenceDiagram from "@/components/react-flow/SequenceDiagram/SequenceDiagram"
import SequenceActor from "@/components/react-flow/SequenceDiagram/SequenceActor"
import SequenceAction from "@/components/react-flow/SequenceDiagram/SequenceAction"

# Secuencia de SCUDO

### Validación existosa

<SequenceDiagram customView={{ height:"790px", x:90, y:27.2727 }}> 
  <SequenceActor id="actor" color="bg-sky-500" label="Actor" positionX="0" positionY="0" height="960px" />
  <SequenceActor id="merchant" label="Merchant" positionX="220" positionY="0" height="960px" />
  <SequenceActor id="api_scudo" color="bg-orange-500" label="API Scudo" positionX="550" positionY="0" height="960px" />
  <SequenceAction 
    id="action1"
    from="actor" 
    to="merchant" 
    message="1: Enter payment data" 
    positionX="30" 
    positionY="70" 
    />
    <SequenceAction 
    id="action2"
    from="actor" 
    to="merchant" 
    message="2: Select pay" 
    positionX="60" 
    positionY="120" 
  />
    <SequenceAction 
    id="action3"
    from="merchant" 
    to="api_scudo" 
    message="3: Request: Post/validate/header..." 
    positionX="265" 
    positionY="210" 
  />
    <SequenceAction 
    id="action4"
    from="api_scudo" 
    to="api_scudo"
    positionX="560" 
    positionY="310" 
    selfAction="true"
    sourcePositionY="199"
    targetPositionY="428"
    message={`<span>4: Perform validation and<br> consumption of internal<br> and external services</span>`} 
  />
    <SequenceAction 
    id="action5"
    from="api_scudo" 
    to="merchant" 
    positionX="250" 
    positionY="440"
    isReturned="true"
    message={`<span>5: Response: {status, date, rules, action}</span>`} 
  />
    <SequenceAction 
    id="action6"
    from="merchant" 
    to="merchant"
    positionX="250" 
    positionY="560" 
    selfAction="true"
    sourcePositionY="480"
    targetPositionY="630"
    message={`<span>6: Make decision according to (action)</span>`} 
  />
    <SequenceAction 
    id="action7"
    from="merchant" 
    to="actor" 
    positionX="40" 
    positionY="740"
    isReturned="true"
    message={`<span>7: Payment response</span>`} 
  />
    <SequenceAction 
    id="action8"
    from="merchant" 
    to="api_scudo" 
    positionX="260" 
    positionY="760"
    message={`<span>8: Request: Post/ notify / header<br> {id, transaction, status}</span>`} 
  />
    <SequenceAction 
    id="action9"
    from="api_scudo" 
    to="api_scudo"
    positionX="580" 
    positionY="840" 
    selfAction="true"
    sourcePositionY="760"
    targetPositionY="908"
    message={`<span>9: Update transaction<br> status</span>`} 
  />
    <SequenceAction 
    id="action10"
    from="api_scudo" 
    to="merchant" 
    positionX="270" 
    positionY="920"
    isReturned="true"
    message={`<span>10: Response: {status, data}</span>`} 
  />
</SequenceDiagram>
### Validación manual de una transacción
<img src="/Api_scudo/manual_sequence.png" width="280" style={{ width: '700px', display: 'block', margin: '0 auto' }}/>
<SequenceDiagram customView={{ height:"800px", x:100, y:27.2727, zoom: 0.60 }}> 
  <SequenceActor id="actor" color="bg-sky-500" label="Actor" positionX="-60" positionY="0" height="1250px" />
  <SequenceActor id="merchant" label="Merchant" positionX="180" positionY="0" height="1250px" />
  <SequenceActor id="api_scudo" color="bg-orange-500" label="API Scudo" positionX="550" positionY="0" height="1250px" />
  <SequenceActor id="placetopay" color="bg-orange-500" label="Placetopay transactional security" positionX="750" positionY="0" height="1250px" />
  <SequenceAction 
    id="action1"
    from="actor" 
    to="merchant" 
    message="1. Enter payment data" 
    positionX="-10" 
    positionY="70" 
    />
    <SequenceAction 
    id="action2"
    from="actor" 
    to="merchant" 
    message="2. Select pay" 
    positionX="15" 
    positionY="120" 
  />
    <SequenceAction 
    id="action3"
    from="merchant" 
    to="api_scudo" 
    message={`<span>3. Request: Post/validate/header<br> {locale,payer, buyer, shipping, payment,<br> instrument, ip_address}</span>`} 
    positionX="225" 
    positionY="170" 
  />
    <SequenceAction 
    id="action4"
    from="api_scudo" 
    to="api_scudo"
    positionX="560" 
    positionY="260" 
    selfAction="true"
    sourcePositionY="170"
    targetPositionY="380"
    message={`<span>4: Perform validation and<br> consumption of internal<br> and external services</span>`} 
  />
    <SequenceAction 
    id="action5"
    from="api_scudo" 
    to="merchant" 
    positionX="270" 
    positionY="380"
    isReturned="true"
    message={`<span>5: Response: {status, date,<br> rules, action}</span>`} 
  />
    <SequenceAction 
    id="action44"
    from="placetopay" 
    to="placetopay"
    positionX="760" 
    positionY="500" 
    selfAction="true"
    sourcePositionY="420"
    targetPositionY="590"
    message={`<span>6: Approve/reject<br> manually transaction</span>`} 
  />
    <SequenceAction 
    id="action77"
    from="placetopay" 
    to="api_scudo" 
    positionX="598" 
    positionY="590"
    isReturned="true"
    message={`<span>7: Notification:<br> final decision</span>`} 
  />
    <SequenceAction 
    id="action6"
    from="api_scudo" 
    to="api_scudo"
    positionX="570" 
    positionY="740" 
    selfAction="true"
    sourcePositionY="650"
    targetPositionY="820"
    message={`<span>8: Update transaction<br> status</span>`} 
  />
    <SequenceAction 
    id="action7"
    from="api_scudo" 
    to="merchant" 
    positionX="280" 
    positionY="832"
    isReturned="true"
    message={`<span>9: Response: {status, data}</span>`} 
  />
    <SequenceAction 
    id="action66"
    from="merchant" 
    to="merchant"
    positionX="220" 
    positionY="950" 
    selfAction="true"
    sourcePositionY="872"
    targetPositionY="1020"
    message={`<span>10: Make decision according to (action)</span>`} 
  />
    <SequenceAction 
    id="action_payment"
    from="merchant" 
    to="actor" 
    positionX="-15" 
    positionY="1020"
    isReturned="true"
    message={`<span>11:Payment response</span>`} 
  />
      <SequenceAction 
    id="action_request"
    from="merchant" 
    to="api_scudo" 
    positionX="250" 
    positionY="1070"
    message={`<span>12:Request: Post/notify/header<br>{id, transaction, status}</span>`} 
  />
    <SequenceAction 
    id="action_update"
    from="api_scudo" 
    to="api_scudo"
    positionX="570" 
    positionY="1130" 
    selfAction="true"
    sourcePositionY="1070"
    targetPositionY="1188"
    message={`<span>13: Update transaction <br>status</span>`} 
  />
    <SequenceAction 
    id="action_response"
    from="api_scudo" 
    to="merchant" 
    positionX="250" 
    positionY="1200"
    isReturned="true"
    message={`<span>14:Response: {status, data}</span>`} 
  />
</SequenceDiagram>
## Conceptos

### Motor de reglas
Sistema que permite analizar transacciones a través de reglas y grupos de reglas con flujos dinámicos definidos por el cliente.

### Riesgo Historico de Placetopay
Consiste en realizar un análisis histórico de las compras que ha tenido el usuario pagando a través de la plataforma Placetopay. Con esta información, el sistema de control de fraude genera un Score de riesgo y, dependiendo de la parametrización definida por el cliente, define si la transacción puede ser procesada o requiere validación por otros módulos de seguridad.

### Riesgo central
Permite validar si la tarjeta que están utilizando para la compra está asociada o no al documento de identificación del usuario, adicionalmente valida números telefónicos y correos electrónicos registrados en el pago contra la información que se encuentra en centros de riesgo generando un Score que permite al sistema decidir si la transacción es procesada o si continúa con otros módulos de seguridad. Este módulo solo aplica para Colombia.

### Puntaje de riesgo externo
Valida la reputación del correo electrónico, direcciones IP, nombres, teléfonos y otros asociados a la transacción con el fin de identificar correlaciones con operaciones fraudulentas en otros sitios, generando un puntaje de riesgo que permite la toma de decisiones del sistema.

### Puntaje de riesgo internacional
Valida la información de los usuarios contra motores de riesgo internacionales, permitiendo la validación de seguridad a través de sistemas de aprendizaje automático, generando un puntaje de riesgo basado en el análisis de múltiples variables asociadas con el comportamiento de pago de los usuarios en todo el mundo.

### Acceso a la consola administrativa
A través de nuestra plataforma Placetopay es posible configurar el sistema de control de fraude, visualizar transacciones, reglas aplicadas, usuarios, crear invitaciones, generar reportes y estadísticas.



