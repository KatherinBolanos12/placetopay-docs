export const description = 'Learn about transaction modifiers';

# Transaction Modifiers

Transaction modifiers are configurations at the merchant level that add a cost to each transaction made. These modifiers are only applied to payment methods that support dispersion-type payments, as the charge is made through a dispersion to the merchant (agreement) configured in the transaction modifier. They are also implemented exclusively for the following payment types: Simple, Partial, and Dispersion.

| Configuration    | Description                                                                                                           |
|------------------|-----------------------------------------------------------------------------------------------------------------------|
| Type             | Defines the type of payment modifier. Currently, only the "Fee" option is available.                                  |
| Status           | Activates or deactivates the configured modifier.                                                                     |
| Agreement        | Identifier of the merchant to which the commission corresponding to the transaction cost will be sent.                |
| Fixed Amount     | Fixed value of the commission to be added to the original transaction cost.                                           |
| Percent Amount   | Percentage to be added to the original transaction cost, calculated based on the total value of the transaction.       |
| Apply Tax        | Defines whether VAT will be applied to the additional cost generated by the transaction.                              |

## Integrating Transaction Modifiers
This functionality is supported through our API [Web Checkout](/checkout), which allows integrating various payment methods and payment types that are compatible with transaction modifiers and their configurations.

## Calculating Transaction Modifier Cost
This calculation is performed considering the currency configured in the merchant or merchants associated with the transaction modifier. For example, if the merchant's currency is `USD` and it does not match the request's currency `COP`, the **Fixed Amount** of the transaction modifier will be converted from `USD` to `COP`, using the conversion rate at the time of the request, before continuing with the commission calculation of the transaction.

The calculated commission is broken down based on the original transaction amount into the [additional fields](/checkout/additional-fields) of the original request sent by the merchant. These fields include `Subtotal`, `Transaction Cost`, and if the transaction modifier has the `Applies Tax` option enabled, the `VAT on Transaction Cost` will also be added. These descriptions do not support language changes and are created based on the language sent in the first request from the merchant.

### Basic Payments
[Basic payments](/checkout/create-session#partial-payment) are modified and become a [dispersion payment](/checkout/create-session#dispersion-payment). The first dispersion contains the original amount of the merchant's request, while the second dispersion includes the transaction costs plus the corresponding tax of the configured transaction modifier.

Example:
* Type: Fee
* Fixed Amount:  0.35
* Percentage Amount: 5%
* Applies Tax:  yes  (10% is obtained from the tax configured in the merchant)

Original merchant request:

```json
{
  ...
  "payment": {
      "reference": "test_basic_payment",
      "description": "basic_payment",
      "amount": { "currency": "USD", "total": 100 },
       ...
    },
  ...
}
```

Result of the request with the application of a transaction modifier:

```json
{
  ...
  "payment": {
      "reference": "test_basic_payment",
      "description": "basic_payment",
      "amount": { "currency": "USD", "total": 105.89 },
      "dispersion": [ 
        {
          "agreement": 1 // merchant identifier making the request.
          "agreementType": "MERCHANT",
          "amount": { "currency": "USD", "total": 100 }  
        },
        {
          "agreement": 14 // configured merchant agreement for the request.
          "agreementType": "MERCHANT",
          "amount": { "currency": "USD", "total": 5.89 }  
        }
      ],
      "fields": [
          {"value": "US$ 100.00", "keyword": "Subtotal", "displayOn": "both"},
          {"value": "US$ 5.35", "keyword": "Transaction Cost", "displayOn": "both"},
          {"value": "US$ 0.54", "keyword": "VAT on Transaction Cost", "displayOn": "both"},
        ]
       ...
    },
  ...
}
```

### Partial Payments
[Partial payments](/en/checkout/create-session#partial-payment) do not directly support [dispersion payments](/checkout/create-session#dispersion-payment). To apply transaction modifiers, the option to make __partial payments__ is disabled, and the same behavior used previously in basic payments is employed.

### Payments with Dispersions
For [payments with dispersions](/en/checkout/create-session#dispersion-payment), an additional dispersion will be added to those originally sent in the merchant's request.
 
Each dispersion is linked to an agreement that contains a configured transaction modifier. This will be applied to the base amount of each dispersion, and the total sum of these commissions will be reflected in the new dispersion of the transaction.

Example:  
> In this case, all the agreements (agreement) of the dispersions have the same transaction modifier properties configured.

* Type: Fee
* Fixed Amount:  0.35
* Percentage Amount: 5%
* Applies Tax: When (10% is obtained from the tax configured in the merchant)

Original merchant request with two dispersions:

```json
{
  ...
  "payment": {
      "reference": "test_dispersion_payment",
      "description": "dispersion_payment",
      "amount": { "currency": "USD", "total": 100 },
      "dispersion": [ 
        {
          "agreement": 1,
          "agreementType": "MERCHANT",
          "amount": { "currency": "USD", "total": 50 }  
        },
        {
          "agreement": 2,
          "agreementType": "MERCHANT",
          "amount": {  "currency": "USD", "total": 25 }  
        },
        {
          "agreement": 3,
          "agreementType": "MERCHANT",
          "amount": {  "currency": "USD", "total": 25 }  
        }
      ]
    },
  ...
}
```

Result of the request with the application of a transaction modifier:

```json
{
  ...
  "payment": {
      "reference": "test_dispersion_payment",
      "description": "dispersion_payment",
      "amount": { "currency": "USD", "total":  113.15 },
      "dispersion": [ 
        {
          "agreement": 1
          "agreementType": "MERCHANT",
          "amount": { "currency": "USD", "total": 50 }  
        },
        {
          "agreement": 2
          "agreementType": "MERCHANT",
          "amount": {  "currency": "USD", "total": 25 }  
        },
        {
          "agreement": 3
          "agreementType": "MERCHANT",
          "amount": {  "currency": "USD", "total": 25 }  
        }
        {
          "agreement": 14 // configured merchant agreement for the request.
          "agreementType": "MERCHANT",
          "amount": {  "currency": "USD", "total": 13.15 }  
        }
      ],
      "fields": [
          {"value": "US$ 100.00", "keyword": "Subtotal", "displayOn": "both"},
          {"value": "US$ 11.05", "keyword": "Transaction Cost", "displayOn": "both"},
          {"value": "US$ 2.10", "keyword": "VAT on Transaction Cost", "displayOn": "both"},
        ]
    },
  ...
}
```

## FAQs
<details>
<summary>How do I configure a transaction modifier for a merchant?</summary>
<p>request must be made to our operations team through Helpdesk, either for the creation of a new merchant or for modifying an existing one, including transaction modifier configurations.</p>
</details>

<details>
<summary>How can transaction modifier payments be visualized?</summary>
<h4>Basic Payment</h4>
<p>In the transaction panel, a transaction with the original requested amount can be viewed, along with additional transactions showing the commission for the original transaction cost.</p>
<h4>Payment with Dispersions</h4>
<p>In the transaction panel, the transactions along with their original dispersions and amounts can be viewed. Additionally, a new dispersion is included that groups the commissions for each transaction cost from the requested dispersions.</p>
</details>

<details>
<summary>How many dispersions can be sent with payment modifiers?</summary>
<p>The current configuration allows a maximum of 3 dispersions for all countries, and 4 for Ecuador. It is important to consider that since the transaction modifier adds an additional transaction to collect the commission, the maximum allowed is 3 dispersions in the request for Ecuador and 2 for other countries.</p>
</details>