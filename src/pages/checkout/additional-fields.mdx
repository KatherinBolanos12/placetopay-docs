export const description =
   'La propiedad fields es una estructura utilizada para relacionar productos o artículos en el proceso. Puede contener varios objetos NameValuePair que representan diferentes datos a anexar en el proceso.'

# Campos Adicionales

La propiedad `fields` se usa para almacenar datos estructurados que pueden visualizarse en la interfaz de Checkout según las condiciones indicadas. {{ className: "leading" }}

Por ejemplo, es posible almacenar información própia de tu sistema, como el ID de la orden `cmsOrderId` o el ID del usuario que está realizando el proceso de pago `cmsUserId`.

La propiedad `fields` se compone de un conjunto de objetos del tipo [NameValuePair](#name-value-pair) donde se definen los datos a guardar.

Los datos a guardar se pueden enviar en estructuras como:

- `redirectRequest.fields`
- `redirectRequest.payment.fields`
- `redirectRequest.subscription.fields`

## Condiciones

- Se pueden agregar hasta 50 campos adicionales. Los campos en `redirectRequest.fields` se validarán primero, y el resto se asignará a `redirectRequest.payment.fields` o `redirectRequest.subscription.fields`.
- Se permite un máximo de 255 caracteres en la propiedad `value`.
- Se permite un máximo de 50 caracteres en la propiedad `keyword`.
- Cuando envías múltiples `fields` con el mismo `keyword`, nuestra API elige el primero para almacenar y mostrar en la interfaz.

<Note>
Los datos con la propiedad `display: both, receipt, payment, approved`, se mostrarán en algún flujo de la interfaz.
</Note>

## NameValuePair {{ id: "name-value-pair" }}

Estructura para permite relacionar información relevante y controlar cuando se mostrara en el proceso de cobro.

<Row>
    <Col>
        <Properties>
            <Property name="keyword" type="string" isRequired={true}>
                Identificador o índice del dato a anexar.<br/>
                EJ: `cmsInvoiceId`
            </Property>
            <Property name="value" type="string|object|array|boolean|number" isRequired={false}>
                Valor del dato a anexar.<br/>
                EJ: `ID_2233`
            </Property>
            <Property name="displayOn" type="string" isRequired={false}>
                Indica en qué condiciones se muestra el dato anexo.<br/>
                Puedes usar esto para decidir si deseas que ciertos datos se vean durante la captura de datos, en el resultado del proceso, en ambas etapas o nunca.<br/>
                Uno de: `none`, `payment`, `receipt`, `both`, `approved`.
            </Property>
        </Properties>
    </Col>
    <Col sticky>

        ```json {{ 'title': 'NameValuePair' }}
        {
            "keyword": "cmsInvoiceId",
            "value": "string",
            "displayOn": "both"
        }
        ```
    </Col>
</Row>

### Propiedad `value`

Si no se especifica ningún valor para la propiedad `value`, su valor por defecto será `null`

La propiedad `value` permite almacenar diferentes tipos de datos. Sin embargo, para mejorar la experiencia del usuario en la interfaz, se mostrarán solo los valores que puedan ser presentados de manera comprensible.

**Ejemplos**

| Valor                                             | Se visualiza como            |
|---------------------------------------------------|------------------------------|
| `true`                                            | true                         |
| `0`                                               | 0                            |
| `1234`                                            | 1234                         |
| `string`                                          | string                       |
| `"''"`                                            | ''                           |
| `""`                                              |                              |
| `{"key1":"value1"}`                               | No se muestra en la interfaz |
| `{"key1":{"key1":"value1"}}`                      | No se muestra en la interfaz |
| `["string1"]`                                     | string1                      |
| `["string1","string2"]`                           | string1, string2             |
| `[{"key1":"value1"},{"key2":"value2"}]`           | No se muestra en la interfaz |
| `[{"key1":"value1"},"string1",["key1","value1"]]` | string1                      |


### Propiedad `displayOn`

Si no se especifica ningún valor para la propiedad `displayOn`, su valor por defecto será `none`

| Valor       | Descripción                                                                                                                                                           |
|-------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `none`      | No se muestra en ninguna vista del proceso de cobro. Esta opción es ideal si deseas mantener este dato oculto durante todo el proceso.                                |
| `both`      | Se muestra en todas las vistas del proceso de cobro.                                                                                                                  |
| `payment`   | Se muestra únicamente en la vista de captura de información. Si deseas que los usuarios vean este dato mientras ingresan datos, elige esta opción.                    |
| `receipt`   | Se muestra solo en la vista de resultado de cobro. Esta opción es perfecta para mostrar información específicamente en la etapa final del proceso de cobro            |
| `approved`  | Se muestra en la vista de resultado de cobro solo si el cobro fue exitoso.                                                                                            |


## Datos adicionales de procesamiento por Rest Services

Además de los campos adicionales de `request.fields` existen otros datos adicionales que son agregados en el procesamiento de la transacción por parte de Rest, y estos datos se encuentran en `payment.processorFields`.

```json
{
    "requestId": 7,
    "status": { /* ... */ },
    "request": {
        "payment": {
            "fields": [
                {
                    "keyword": "_test_field_",
                    "value": "_test_field_value_",
                    "displayOn": "payment"
                }
            ]
            // ...
        },
        "fields": [
            {
                "keyword": "_processUrl_",
                "value": "https://spa.redirection.test/spa/session/7/87e0235ec988966d87213d5b5c86b103",
                "displayOn": "none"
            },
            {
                "keyword": "_session_",
                "value": 7,
                "displayOn": "none"
            }
        ],
        // ...
    },
    "payment": [
        {
            "processorFields": [
                {
                    "value": "00990101",
                    "keyword": "terminalNumber",
                    "displayOn": "none"
                },
                {
                    "value": "529259",
                    "keyword": "bin",
                    "displayOn": "none"
                },
                {
                    "value": "0745",
                    "keyword": "lastDigits",
                    "displayOn": "none"
                },
                {
                    "value": "b466b12c2a248122c9448783c77435ed",
                    "keyword": "id",
                    "displayOn": "none"
                },
                {
                    "value": "000",
                    "keyword": "b24",
                    "displayOn": "none"
                },
                /// ...
            ],
            // ...
        }
    ],
}
```

Estos mismos datos tienen la misma estructura de [NameValuePair](#name-value-pair), y estos son aquellos en [Datos adicionales de Gateway](/gateway/additional-data)

Adicional a estos datos, existen otros como:

Clave               | Ejemplo           | Descripción                     
--------------------|-------------------|------------------------
`id`                | "b466b12c2a248122c9448783c77435ed"             | Identificador de la sessión de Gateway 
`b24`               | "000"             | Estado de la transacción en ISO 24 de Gateway
`_processUrl_`      | "/payment/200/f6909d32655225f25d28ce699e5f34b1"  | url de la sessión de pago
`_walletMethodId_`  | 50                 | Identificador de método de pago
`_wcTransactionId_` | 100               | Identificador de la transacción
`_wcSubscriptionId_`| 30               | Identificador de la subscripción
`_session_`         | 200               | Identificador de la sessión de Checkout
